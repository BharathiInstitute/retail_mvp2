rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    // Allow read for public assets if needed (none by default)
    // match /public/{document=**} {
    //   allow read: if true;
    // }

    // Inventory collection (products)
    match /inventory/{docId} {
      // Public read access so all users (including unauthenticated) can view products
      allow get, list, read: if true;
      // Restrict writes to authenticated users only (tighten later per-tenant if needed)
      allow create, update, delete: if isSignedIn();
    }

    // Add other modules as they move to Firestore (examples):
    // match /suppliers/{docId} { allow read, write: if isSignedIn(); }
    // match /transfers/{docId} { allow read, write: if isSignedIn(); }

    function isSignedIn() {
      return request.auth != null;
    }

    // For stricter multi-tenant control, replace the rule above with:
    // function isTenantOwner(tenantId) {
    //   return request.auth != null && request.auth.uid == tenantId;
    // }
    // match /inventory/{docId} {
    //   allow read, write: if isTenantOwner(resource.data.tenantId);
    // }
  }
}
